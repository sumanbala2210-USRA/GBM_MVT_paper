# simulation_ALL.yaml
# ===================================================================
#  1. PROJECT SETTINGS
# ===================================================================
# Global settings for the entire project, read by all scripts.
project_settings:
  # The base directory for all generated event files.
  data_path: '001_DATA' # where your simulation data will be stored
  results_path: '01_ANALYSIS_RESULTS' # where your analysis results will be stored
  haar_python_path: "/Users/sbala/anaconda3/bin/python" # path to the Haar Python executable


# ===================================================================
#  2. PULSE DEFINITIONS (The "Library")
# ===================================================================
# Define all known pulse shapes and their specific parameters here ONCE.
# Campaigns below will refer to these by name.
pulse_definitions:
  gaussian:
    parameters:
      sigma: [0.1, 0.03, 0.01, 0.003]
    
    constants:
      center_time: 0.0

  triangular:
    parameters:
      width: [0.1] 
      peak_time_ratio: [0.5, .2, 0.8]
    constants:
      center_time: 0.0


  norris:
    parameters:
      rise_time: [0.1, 0.01, 0.005] 
      decay_time: [0.01, 0.005 ] 
    constants:
      start_time: 0.0
  
  fred:
    parameters:
      rise_time: [.1] 
      decay_time: [.2] 
    constants:
      start_time: 0.0

  lognormal:
    parameters:
      sigma: [.1] 
      center_time: [.2] 
  
  complex_pulse:
    parameters:
      position: [6.2] 
      overall_amplitude: [5] 
    constants: {}

  complex_pulse_long:
    parameters:
      position: [6.2] 
      overall_amplitude: [5] 
    constants: {}

  complex_pulse_short:
    parameters:
      position: [6.2] 
      overall_amplitude: [1] 
    constants: {}
  
  complex_pulse_short_2p10ms:
    parameters:
      position: [6.2] 
      overall_amplitude: [5] 
    constants: {}

  complex_pulse_short_2p3ms:
    parameters:
      position: [6.2] 
      overall_amplitude: [100] 
    constants: {}

# ===================================================================
#  3. SIMULATION CAMPAIGNS
# ===================================================================


# Each campaign defines a set of simulations to generate.
# This section is read by 'generate_events.py'.
# ______________________________________
#  GBM
# ______________________________________
simulation_campaigns:
- name: GBM_Pulse_Simulation
  type: gbm
  enabled: false

  # Parameters that vary for this entire campaign
  parameters:
    peak_amplitude: [10.0, 3.0, 1.0, 0.3, 0.1, 0.03, 0.01] #, 0.5, 1.0]
    all_flag: true
    trigger_set:
      - {trigger_number: 211211549, angle: 20, det: 'all', background_intervals: [[-20, -5.0],[75, 200]]}
      #- {trigger_number: 250723551, angle: 30, det: ['n3'], background_intervals: [[-15, -5.0], [80, 210]]}
      #- {trigger_number: 250709653, angle: 40, det: ['n3'], background_intervals: [[-20, -5.0, 75, 200]]}

  # Constants for this entire campaign
  constants:
    background_level: 0.3
    random_seed: 37
    t_start: 4.0
    t_stop: 12.0
    en_lo: 8.0
    en_hi: 900.0
    gbm_data_path: None
    total_sim: 100


  # List the pulse shapes from the library you want to run in this campaign.
  pulses_to_run:
    # - gaussian
    # - triangular
    # - norris
    # - fred
    # - lognormal
    # - complex_pulse  # Example of enabling a pulse for this campaign


# ______________________________________
#  Functions
# ______________________________________

- name: FUNCTION_Pulse_Simulation
  type: function
  enabled: true

  parameters:
    peak_amplitude: [5] 

  constants:
    trigger_number: 99999999
    det: x
    angle: 0
    t_start: 4
    t_stop: 12
    background_level: 1
    scale_factor: 1000
    random_seed: 37
    grid_resolution: 0.00001
    total_sim: 30

  # This campaign will only run the gaussian and norris simulations.
  pulses_to_run:
    # - gaussian
    # - triangular  # Example of disabling a pulse for this campaign
    - norris
    # - fred
    # - lognormal
    # - complex_pulse  # Example of enabling a pulse for this campaign
    # - complex_pulse_long  # Example of enabling a pulse for this campaign
    # - complex_pulse_short
    # - complex_pulse_short_2p10ms
    # - complex_pulse_short_2p3ms

# ===================================================================
#  4. ANALYSIS SETTINGS
# ===================================================================
# This section is read by your 'analyze.py' script.
analysis_settings:
  # The analysis script will test every event file against these bin widths
  bin_widths_to_analyze_ms: [0.1] #, 0.1] #, 0.001] #, 0.001] #, 0.01]
  snr_timescales: [0.010, 0.016, 0.032, 0.064, 0.128, 0.256]
  detector_selections: [['n2'], ['n2', 'na'], ['n2', 'na', 'n1'], ['all']]
  extra_pulse: { pulse_shape: 'gaussian', sigma: 0.003, center_time: 0.0 }

