# simulation_ALL.yaml
# ===================================================================
#  1. PROJECT SETTINGS
# ===================================================================
# Global settings for the entire project, read by all scripts.
project_settings:
  # The base directory for all generated event files.
  data_path: '001_DATA' # where your simulation data will be stored
  results_path: '01_ANALYSIS_RESULTS' # where your analysis results will be stored
  haar_python_path: "/Users/sbala/anaconda3/bin/python" # path to the Haar Python executable
  #pulse_path: 

# ===================================================================
#  2. PULSE DEFINITIONS (The "Library")
# ===================================================================
# Define all known pulse shapes and their specific parameters here ONCE.
# Campaigns below will refer to these by name.
pulse_definitions:
  gaussian:
    parameters:
      sigma: [0.03]
      #sigma: [0.05, 0.01] # [0.01, 0.05, 0.1, 0.5, 1.0]
    constants:
      center_time: 0.0

  triangular:
    parameters:
      width: [0.1] #, 0.02] # 0.0005, 0.001, 0.005, 0.01, 0.05, 0.1, 0.5, 1.0] #[0.01, 0.05] #, 0.001, 0.005, 0.01, 0.05, 0.1, 0.5, 1.0]
      #peak_time_ratio: [0.5, .2, 0.8]
    constants:
      center_time: 0.0
      peak_time_ratio: 0.5

  norris:
    parameters:
      rise_time: [0.01, 0.005] #1, 0.0005, 0.001, 0.005, 0.01, 0.05, 0.1, 0.5]
      decay_time: [0.01] #, 0.02, 0.05, 0.1, 0.2, 0.5]
    constants:
      start_time: 0.0
  
  fred:
    parameters:
      # NOTE: Combined values from both of your original campaigns
      rise_time: [.1] #[0.0001, 0.0005, 0.001, 0.005, 0.01, 0.05, 0.1, 0.5, 1.0]
      decay_time: [.2] #[0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1.0]
    constants:
      start_time: 0.0

  lognormal:
    parameters:
      sigma: [.1] #[0.0001, 0.0005, 0.001, 0.005, 0.01, 0.05, 0.1, 0.5, 1.0]
      center_time: [.2] #[0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1.0]
  
  complex_pulse:
    parameters:
      # This is the second argument to your wrapper ('position')
      position: [6.2] #, 4.5] #, 6.0, 8.0, 10, 12, 14] #, 6.0]
      overall_amplitude: [5] #[1, 2, 3, 4, 5, 10] #, 10.0, 20.0, 50.0, 100.0]
    constants: {}

  complex_pulse_long:
    parameters:
      # This is the second argument to your wrapper ('position')
      position: [6.2] #, 4.5] #, 6.0, 8.0, 10, 12, 14] #, 6.0]
      overall_amplitude: [5] #[1, 2, 3, 4, 5, 10] #, 10.0, 20.0, 50.0, 100.0]
    constants: {}

  complex_pulse_short:
    parameters:
      # This is the second argument to your wrapper ('position')
      position: [6.2] #, 4.5] #, 6.0, 8.0, 10, 12, 14] #, 6.0]
      overall_amplitude: [1] #, 2, 3, 4, 5, 10, 50.0, 100.0] #[100] #[1, 2, 3, 4, 5, 10] #, 10.0, 20.0, 50.0, 100.0]
    constants: {}
  
  complex_pulse_short_2p10ms:
    parameters:
      # This is the second argument to your wrapper ('position')
      position: [6.2] #, 4.5] #, 6.0, 8.0, 10, 12, 14] #, 6.0]
      overall_amplitude: [5] #[1, 2, 3, 4, 5, 10] #, 10.0, 20.0, 50.0, 100.0]
    constants: {}

  complex_pulse_short_2p3ms:
    parameters:
      # This is the second argument to your wrapper ('position')
      position: [6.2] #, 4.5] #, 6.0, 8.0, 10, 12, 14] #, 6.0]
      overall_amplitude: [100] #[1, 2, 3, 4, 5, 10] #, 10.0, 20.0, 50.0, 100.0]
    constants: {}

# ===================================================================
#  3. SIMULATION CAMPAIGNS
# ===================================================================
# Each campaign defines a set of simulations to generate.
# This section is read by 'generate_events.py'.


# ______________________________________
#  GBM
# ______________________________________
simulation_campaigns:
- name: GBM_Pulse_Simulation
  type: gbm
  enabled: true

  # Parameters that vary for this entire campaign
  parameters:
    peak_amplitude: [0.5] #, 0.5, 1.0]
    all_flag: true
    trigger_set:
      - {trigger_number: 211211549, angle: 20, det: 'all', background_intervals: [[-20, -5.0],[75, 200]]}
      #- {trigger_number: 250723551, angle: 30, det: ['n3'], background_intervals: [[-15, -5.0], [80, 210]]}
      #- {trigger_number: 250709653, angle: 40, det: ['n3'], background_intervals: [[-20, -5.0, 75, 200]]}

  # Constants for this entire campaign
  constants:
    background_level: 0.3
    random_seed: 37
    t_start: 4.0
    t_stop: 12.0
    en_lo: 8.0
    en_hi: 900.0
    gbm_data_path: None
    total_sim: 30


  # List the pulse shapes from the library you want to run in this campaign.
  pulses_to_run:
    - gaussian
    # - triangular
    # - norris
    # - fred
    # - lognormal
    # - complex_pulse  # Example of enabling a pulse for this campaign
# ______________________________________
#  Functions
# ______________________________________

- name: FUNCTION_Pulse_Simulation
  type: function
  enabled: false

  parameters:
    #peak_amplitude: [2] # [0.01, 1, 2, 3, 4, 5]  #[0.02, 0.03, 0.04, 0.05, 0.1, 1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15, 16, 20, 25, 30, 40, 50, 100, 200, 300, 400, 500]
    peak_amplitude: [0.01] #, 0.02, 0.03, 0.04, 0.05, 0.1, 1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15, 16, 20, 25, 30, 40, 50] #, 100, 200, 300, 400, 500]

  constants:
    trigger_number: 99999999
    det: x
    angle: 0
    t_start: 4
    t_stop: 12
    background_level: 1
    scale_factor: 1000
    random_seed: 37
    grid_resolution: 0.00001
    total_sim: 1

  # This campaign will only run the gaussian and norris simulations.
  pulses_to_run:
    # - gaussian
    # - triangular  # Example of disabling a pulse for this campaign
    # - norris
    # - fred
    # - lognormal
    # - complex_pulse  # Example of enabling a pulse for this campaign
    # - complex_pulse_long  # Example of enabling a pulse for this campaign
    # - complex_pulse_short
    # - complex_pulse_short_2p10ms
    # - complex_pulse_short_2p3ms

# ===================================================================
#  4. ANALYSIS SETTINGS
# ===================================================================
# This section is read by your 'analyze.py' script.
analysis_settings:
  # The analysis script will test every event file against these bin widths
  bin_widths_to_analyze_ms: [0.1] #, 0.1] #, 0.001] #, 0.001] #, 0.01]
  snr_timescales: [0.010, 0.016, 0.032, 0.064, 0.128, 0.256]
  snr_bw_ms: [16, 32, 64]  # The bin width (in ms) to use for the detector selection optimization
  #detector_selections: [['n0'], ['n2', 'na'], ['all']]
  detector_selections: [['n2'], ['n2', 'na'], ['n2', 'na', 'n1'], ['n2', 'na', 'n1', 'n9'], ['n2', 'na', 'n1', 'n9', 'n5'], ['n2', 'na', 'n1', 'n9', 'n5', 'nb'], ['n2', 'na', 'n1', 'n9', 'n5', 'nb', 'n0'], ['n2', 'na', 'n1', 'n9', 'n5', 'nb', 'n0', 'n8'], ['n2', 'na', 'n1', 'n9', 'n5', 'nb', 'n0', 'n8', 'n4'], ['n2', 'na', 'n1', 'n9', 'n5', 'nb', 'n0', 'n8', 'n4', 'n3'], ['n2', 'na', 'n1', 'n9', 'n5', 'nb', 'n0', 'n8', 'n4', 'n3', 'n7'], ['n2', 'na', 'n1', 'n9', 'n5', 'nb', 'n0', 'n8', 'n4', 'n3', 'n7', 'n6']]
  extra_pulse: { pulse_shape: 'gaussian', sigma: 0.003, center_time: 0.0 }
  mvt_time_window: 0.5 
  mvt_step_size: 0.5
  #detector_selections: [ ['all'] ]
